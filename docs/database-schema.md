
# Database Schema for HEX THE ADD HUB

This document outlines the proposed database schema for the various features of the HEX THE ADD HUB application, adapted for Firebase (Firestore).

## 1. Authentication & Users (Leveraging Firebase Authentication)

Firebase Authentication handles user creation, login, social auth, and password resets directly. Firestore will store additional user profile information.

### `users` (Firestore Collection)
Stores additional user profile information beyond what Firebase Auth provides directly. Document ID is the Firebase Auth `uid`.
- `uid`: STRING (Primary Key - Firebase Auth UID)
- `name`: STRING
- `email`: STRING (Indexed, from Firebase Auth)
- `avatar_url`: STRING (Optional, URL to avatar image - can be Firebase Storage link)
- `bio`: STRING (Optional, user's biography)
- `dashboard_layout_preferences`: MAP (Optional, stores user's dashboard widget layout)
  - e.g., `{ "widgetOrder": ["recommendations", "activity", "progress"], "widgetSettings": { "activity": { "span": 2 } } }`
- `created_at`: TIMESTAMP (Default: Server Timestamp)
- `updated_at`: TIMESTAMP (Default: Server Timestamp)
- `auth_providers_linked`: ARRAY of MAPS (Optional, to track which social providers are linked, if needed beyond Firebase Auth's own tracking)
  - `provider_name`: STRING (e.g., 'google.com', 'github.com', 'facebook.com')
  - `provider_user_id`: STRING

*Note: `password_hash` is managed by Firebase Authentication.*

## 2. Portfolios (Projects)

### `projects` (Firestore Collection)
Stores details about user-created projects. Document ID can be auto-generated by Firestore or a custom slug.
- `id`: STRING (Document ID)
- `user_id`: STRING (Foreign Key to `users.uid` - author, Indexed)
- `title`: STRING
- `description`: STRING (Short description)
- `long_description`: STRING (Optional, detailed description, could be Markdown)
- `image_url`: STRING (URL to project image, potentially Firebase Storage)
- `project_link`: STRING (Optional, URL to live project or repository)
- `tags`: ARRAY of STRINGS (e.g., ['NFT', 'Solidity', 'AI']) (Indexed for filtering)
- `published_date`: TIMESTAMP
- `status`: STRING (e.g., 'draft', 'published', 'archived', Default: 'draft')
- `created_at`: TIMESTAMP
- `updated_at`: TIMESTAMP

### `project_contributions` (Firestore Subcollection under `projects/{projectId}/contributions` or top-level collection)
Tracks user contributions to projects for points and activity.
- `id`: STRING (Document ID)
- `user_id`: STRING (Foreign Key to `users.uid`, Indexed)
- `project_id`: STRING (Foreign Key to `projects.id`, Indexed)
- `contribution_type`: STRING (e.g., 'code_commit', 'design_asset', 'documentation', 'feedback')
- `description`: STRING (Optional, details about the contribution)
- `contribution_date`: TIMESTAMP
- `points_awarded`: NUMBER (Default: 0)

## 3. Courses

### `courses` (Firestore Collection)
Stores information about available courses.
- `id`: STRING (Document ID)
- `instructor_id`: STRING (Foreign Key to `users.uid`, Indexed)
- `title`: STRING
- `slug`: STRING (Unique, Indexed, for SEO-friendly URLs)
- `description`: STRING
- `long_description`: STRING (Optional, detailed course page content)
- `image_url`: STRING
- `price_amount`: NUMBER (Nullable, if 'Free')
- `price_currency`: STRING (e.g., 'USD', Nullable)
- `is_free`: BOOLEAN (Default: false)
- `category`: STRING (Indexed)
- `level`: STRING (e.g., 'Beginner', 'Intermediate', 'Advanced', Indexed)
- `duration_text`: STRING (e.g., "6 weeks", "Approx 20 hours")
- `lessons_count`: NUMBER
- `status`: STRING (e.g., 'draft', 'published', 'archived', Default: 'draft')
- `created_at`: TIMESTAMP
- `updated_at`: TIMESTAMP

### `course_modules` (Firestore Subcollection under `courses/{courseId}/modules`)
- `id`: STRING (Document ID)
- `title`: STRING
- `order_index`: NUMBER

### `course_lessons` (Firestore Subcollection under `courses/{courseId}/modules/{moduleId}/lessons`)
- `id`: STRING (Document ID)
- `title`: STRING
- `content_type`: STRING (e.g., 'video', 'text', 'quiz')
- `content_data`: MAP (Stores video URL, text content, quiz structure, etc.)
- `order_index`: NUMBER
- `estimated_duration_minutes`: NUMBER (Optional)

### `course_enrollments` (Firestore Collection)
Tracks user enrollment and progress. Document ID could be `userId_courseId`.
- `id`: STRING (Document ID)
- `user_id`: STRING (Foreign Key to `users.uid`, Indexed)
- `course_id`: STRING (Foreign Key to `courses.id`, Indexed)
- `enrolled_at`: TIMESTAMP
- `progress_percentage`: NUMBER (0-100, Default: 0)
- `completed_lessons`: ARRAY of STRINGS (lesson_ids, Default: [])
- `last_accessed_lesson_id`: STRING (Nullable)
- `completed_at`: TIMESTAMP (Nullable)

### `course_ratings` (Firestore Subcollection under `courses/{courseId}/ratings`)
Document ID can be `user_id`.
- `user_id`: STRING
- `rating`: NUMBER (1-5)
- `comment`: STRING (Optional)
- `created_at`: TIMESTAMP
- `updated_at`: TIMESTAMP

## 4. Leaderboard & Gamification

### `user_points` (Firestore Collection)
Stores aggregated points for users. Document ID is `user_id`.
- `user_id`: STRING (Document ID, Foreign Key to `users.uid`)
- `total_points`: NUMBER (Default: 0)
- `monthly_points`: NUMBER (Default: 0, reset periodically via Cloud Function)
- `weekly_points`: NUMBER (Default: 0, reset periodically via Cloud Function)
- `last_updated_at`: TIMESTAMP

### `achievement_definitions` (Firestore Collection)
Defines available achievements. Document ID is `achievement_key`.
- `key`: STRING (Document ID)
- `name`: STRING
- `description`: STRING
- `icon_name`: STRING (Lucide icon name or URL)
- `points_value`: NUMBER (Optional, points awarded)
- `criteria`: MAP (Optional, for defining specific unlock criteria for backend processing)

### `user_achievements` (Firestore Collection or Subcollection under `users/{userId}/achievements`)
Tracks achievements unlocked by users. Document ID could be `achievement_key` if subcollection, or auto-ID if top-level.
- `user_id`: STRING (Indexed)
- `achievement_key`: STRING (Foreign Key to `achievement_definitions.key`, Indexed)
- `achieved_at`: TIMESTAMP
- `metadata`: MAP (Optional, for achievement-specific data)

## 5. Dashboard & User Activity

### `user_activity_events` (Firestore Collection)
Stores various user activities for feeds, recommendations, and analytics.
- `id`: STRING (Document ID)
- `user_id`: STRING (Foreign Key to `users.uid`, Indexed)
- `event_type`: STRING (e.g., 'course_enrollment', 'lesson_completed', 'project_created', 'project_contribution', 'forum_post', 'achievement_unlocked')
- `event_data`: MAP (Contextual data, e.g., `{ "course_id": "uuid", "course_title": "..." }`)
- `timestamp`: TIMESTAMP (Indexed)

## 6. Community & Social (Future Expansion)

### `community_feed_items` (Firestore Collection)
- `id`: STRING (Document ID)
- `user_id`: STRING (Nullable if system-generated)
- `item_type`: STRING (e.g., 'new_project', 'course_completion', 'announcement')
- `title`: STRING
- `description`: STRING (Optional)
- `link`: STRING (Optional)
- `image_url`: STRING (Optional)
- `item_data`: MAP
- `timestamp`: TIMESTAMP (Indexed)

### `direct_messages` (Firestore Collection)
Could be structured with subcollections for messages within a conversation.
- `conversation_id`: STRING (Document ID, e.g., sorted_user_ids_combined)
- `participants`: ARRAY of STRINGS (`user_id`s) (Indexed)
- `last_message_snippet`: STRING
- `last_message_timestamp`: TIMESTAMP (Indexed for sorting conversations)
- `unread_counts`: MAP (e.g., `{ "userId1": 0, "userId2": 2 }`)
- Subcollection: `messages`
    - `id`: STRING (Document ID)
    - `sender_id`: STRING
    - `content`: STRING
    - `timestamp`: TIMESTAMP
    - `read_by`: ARRAY of STRINGS (`user_id`s who have read it)

## 7. Blog (Future Feature)

### `blog_posts` (Firestore Collection)
- `id`: STRING (Document ID)
- `author_id`: STRING
- `title`: STRING
- `slug`: STRING (Unique, Indexed)
- `content_markdown`: STRING
- `excerpt`: STRING (Optional)
- `cover_image_url`: STRING (Optional)
- `status`: STRING ('draft', 'published')
- `published_at`: TIMESTAMP (Nullable)
- `tags`: ARRAY of STRINGS
- `created_at`: TIMESTAMP
- `updated_at`: TIMESTAMP

## 8. Life Tracking

### `life_tracker_settings` (Firestore Document under `users/{userId}/settings/life_tracker_settings`)
Stores user-specific settings.
- `birth_date`: STRING (ISO "yyyy-MM-dd")
- `life_expectancy_years`: NUMBER
- `enable_notifications`: BOOLEAN
- `timezone`: STRING (Optional, IANA timezone name)
- `updated_at`: TIMESTAMP

---
This Firestore schema prioritizes denormalization where appropriate for read efficiency, common in NoSQL databases. Security rules will be crucial to manage access. Cloud Functions can be used for periodic tasks like resetting monthly points or processing complex achievements.
